openapi: 3.0.3
info:
  title: Camoo Payment API (Cashout) - OpenAPI
  version: "1.0.0"
  description: |
    Concrete OpenAPI (Swagger) specification describing the cashout flow and related endpoints found in the repository.
    - Base server example: http://localhost:8000
    - Authentication uses two header API credentials: X-Api-Key and X-Api-Secret.
servers:
  - url: https://api.camoo.cm/v1/payment
    description: Production server
security:
  - ApiKeyAuth: []
  - ApiSecretAuth: []
paths:
  /cashout:
    post:
      tags: [Payment]
      summary: Create a cashout (process payment / transfer)
      operationId: createCashOut
      x-codeSamples:
        - lang: cURL
          source: |
            curl -sS -X POST 'https://api.camoo.cm/v1/payment/cashout' \
            -H 'Content-Type: application/json' \
            -H 'X-Api-Key: YOUR_API_KEY' \
            -H 'X-Api-Secret: YOUR_API_SECRET' \
            -d '{
              "amount": 100,
              "phone_number": "+1234567890",
              "notification_url": "https://myapp.com/webhook",
              "currency": "XAF",
              "external_reference": "my-site-reference",
              "shopping_cart_details": {"top_id": "ORD-12345"}
            }'
        - lang:  Python
          source: |
            import requests

            url = 'https://api.camoo.cm/v1/payment/cashout'
            headers = {
              'Content-Type': 'application/json',
              'X-Api-Key': 'YOUR_API_KEY',
              'X-Api-Secret': 'YOUR_API_SECRET'
            }
            data = {
              "amount": 100,
              "phone_number": "+1234567890",
              "notification_url": "https://myapp.com/webhook",
              "currency": "XAF",
              "external_reference": "my-site-reference",
              "shopping_cart_details": {"top_id": "ORD-12345"}
            }

            response = requests.post(url, json=data, headers=headers)
            print(response.json())

        - lang:   Java
          source: |
            import java.io.OutputStream;
            import java.net.HttpURLConnection;
            import java.net.URL;

            public class CashOutExample {
                public static void main(String[] args) {
                    try {
                        URL url = new URL("https://api.camoo.cm/v1/payment/cashout");
                        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                        conn.setRequestMethod("POST");
                        conn.setRequestProperty("Content-Type", "application/json");
                        conn.setRequestProperty("X-Api-Key", "YOUR_API_KEY");
                        conn.setRequestProperty("X-Api-Secret", "YOUR_API_SECRET");
                        conn.setDoOutput(true);

                        String jsonInputString = "{"
                                + "\"amount\": 100,"
                                + "\"phone_number\": \"+1234567890\","
                                + "\"notification_url\": \"https://myapp.com/webhook\","
                                + "\"currency\": \"XAF\","
                                + "\"external_reference\": \"my-site-reference\","
                                + "\"shopping_cart_details\": {\"top_id\": \"ORD-12345\"}"
                                + "}";

                        try(OutputStream os = conn.getOutputStream()) {
                            byte[] input = jsonInputString.getBytes("utf-8");
                            os.write(input, 0, input.length);           
                        }

                        int code = conn.getResponseCode();
                        System.out.println("Response Code: " + code);
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                }
            }

        - lang:   PHP
          source: |
            <?php
            $url = 'https://api.camoo.cm/v1/payment/cashout';
            $data = array(
              "amount" => 100,
              "phone_number" => "+1234567890",
              "notification_url" => "https://myapp.com/webhook",
              "currency" => "XAF",
              "external_reference" => "my-site-reference",
              "shopping_cart_details" => array("top_id" => "ORD-12345")
            );

            $options = array(
              'http' => array(
                'header'  => "Content-Type: application/json\r\n" .
                             "X-Api-Key: YOUR_API_KEY\r\n" .
                             "X-Api-Secret: YOUR_API_SECRET\r\n",
                'method'  => 'POST',
                'content' => json_encode($data),
              ),
            );
            $context  = stream_context_create($options);
            $result = file_get_contents($url, false, $context);
            if ($result === FALSE) {
              die('Error occurred');
            }

            var_dump($result);
            ?>

        - lang:   Ruby
          source: |
            require 'net/http'
            require 'uri'
            require 'json'

            uri = URI.parse("https://api.camoo.cm/v1/payment/cashout")
            request = Net::HTTP::Post.new(uri)
            request.content_type = "application/json"
            request["X-Api-Key"] = "YOUR_API_KEY"
            request["X-Api-Secret"] = "YOUR_API_SECRET"
            request.body = JSON.dump({
              "amount" => 100,
              "phone_number" => "+1234567890",
              "notification_url" => "https://myapp.com/webhook",
              "currency" => "XAF",
              "external_reference" => "my-site-reference",
              "shopping_cart_details" => { "top_id" => "ORD-12345" }
            })

            req_options = {
              use_ssl: uri.scheme == "https",
            }

            response = Net::HTTP.start(uri.hostname, uri.port, req_options) do |http|
              http.request(request)
            end

            puts response.body

        - lang:  JavaScript
          source: |
            const axios = require('axios');

            const data = {
              amount: 100,
              phone_number: "+1234567890",
              notification_url: "https://myapp.com/webhook",
              currency: "XAF",
              external_reference: "my-site-reference",
              shopping_cart_details: { top_id: "ORD-12345" }
            };

            axios.post('https://api.camoo.cm/v1/payment/cashout', data, {
              headers: {
                'Content-Type': 'application/json',
                'X-Api-Key': 'YOUR_API_KEY',
                'X-Api-Secret': 'YOUR_API_SECRET'
              }
            })
            .then(response => {
              console.log(response.data);
            })
            .catch(error => {
              console.error(error);
            }); 

      description: |
        Initiate a cashout to a recipient (mobile-money, bank or other provider).
        Request must be authenticated with X-Api-Key and X-Api-Secret headers.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CashOutRequest'
            example:
              amount: 100
              phone_number: "+1234567890"
              notification_url: "https://myapp.com/webhook"
              currency: "XAF"
              external_reference: "123-user-site-reference"
              shopping_cart_details:
                order_id: "ORD-12345"
                email: "user@test.com"
                customerName: "John Doe"
                description: "Payment for order ORD-12345"
                langKey: "fr"
                items:
                  - item_id: "item-001"
                    name: "Product 1"
                    quantity: 2
                    unit_price: 25.0
                  - item_id: "item-002"
                    name: "Product 2"
                    quantity: 1
                    unit_price: 50.0
                user_browser_data:
                  userAgent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
                  acceptLanguage: "en-US,en;q=0.9"
                  ipAddress: "1.2.3.4"
      responses:
        "200":
          description: Cashout accepted / Payment resource (synchronous view)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CashOutResponse'
        "400":
          description: Bad request (validation error)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        "401":
          description: Authentication failed (invalid or missing API credentials)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        "402":
          description: Payment or account insufficient funds (implementation-dependent)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        "422":
          description: Unprocessable entity (provider specific validation error)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        "500":
          description: Internal server error / provider failure
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /verify:
    get:
      tags: [Payment]
      summary: Verify transaction status
      operationId: verifyTransaction
      x-codeSamples:
        - lang: cURL
          source: |
            curl -sS -X GET 'https://api.camoo.cm/v1/payment/verify?id=TRANSACTION_ID' \
            -H 'X-Api-Key: YOUR_API_KEY' \
            -H 'X-Api-Secret: YOUR_API_SECRET'
        - lang: Python
          source: |
            import requests

            url = 'https://api.camoo.cm/v1/payment/verify'
            headers = {
              'X-Api-Key': 'YOUR_API_KEY',
              'X-Api-Secret': 'YOUR_API_SECRET'
            }
            params = {
              'id': 'TRANSACTION_ID'
            }

            response = requests.get(url, headers=headers, params=params)
            print(response.json())
      description: |
        Return the payment/cashout resource for the given id. The repository expects the query param name `id`.
        Request must be authenticated with X-Api-Key and X-Api-Secret headers.
      parameters:
        - name: id
          in: query
          required: true
          schema:
            type: string
          description: The transaction id to verify (server-generated id)
      responses:
        "200":
          description: Payment verification result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerifyResponse'
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        "404":
          description: Transaction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /account:
    get:
      tags: [Account]
      summary: Get account balance and metadata
      operationId: getAccountInfo
      x-codeSamples:
        - lang: cURL
          source: |
            curl -sS -X GET 'https://api.camoo.cm/v1/payment/account' \
            -H 'X-Api-Key: YOUR_API_KEY' \
            -H 'X-Api-Secret: YOUR_API_SECRET'
        - lang: Python
          source: |
            import requests

            url = 'https://api.camoo.cm/v1/payment/account'
            headers = {
              'X-Api-Key': 'YOUR_API_KEY',
              'X-Api-Secret': 'YOUR_API_SECRET'
            }

            response = requests.get(url, headers=headers)
            print(response.json())
      description: Returns the account balance and viewed timestamp. Requires API credentials.
      responses:
        "200":
          description: Account information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountResponse'
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-Api-Key
      description: Public API key identifying the caller's account.
    ApiSecretAuth:
      type: apiKey
      in: header
      name: X-Api-Secret
      description: Secret for authenticating the request (use together with X-Api-Key).

  schemas:
    CashOutRequest:
      type: object
      required:
        - amount
        - phone_number
      properties:
        amount:
          type: number
          format: float
          description: |
            Monetary amount to cash out in major currency units (e.g., 100 means 100 XAF or 100 XOF depending on currency).
        phone_number:
          type: string
          description: Recipient phone number in international format (E.164 recommended). Required for mobile-money providers.
        notification_url:
          type: string
          format: uri
          description: HTTPS endpoint that will receive asynchronous status updates (webhook). Optional but recommended.
        external_reference:
          type: string
          description: Client-provided reference identifier for tracking the transaction (e.g., "123-user-site-reference", "my-site-reference"). Optional.
        shopping_cart_details:
          type: object
          additionalProperties: true
          description:  Free-form JSON object with contextual data (order id, platform reference, etc.)
          properties:
            user_browser_data:
              additionalProperties: true
              type: object
              description: Information about the user's browser and network environment.
              properties:
                userAgent:
                  type: string
                  description: User-Agent string from the user's browser.
                acceptLanguage:
                  type: string
                  description: Accept-Language header value indicating the user's language preferences.
                ipAddress:
                  type: string
                  description: IP address of the user making the request.

    Payment:
      type: object
      properties:
        id:
          type: string
          description: Server-generated transaction identifier
        external_reference:
          type: string
          description: Client-provided reference identifier
        amount:
          type: integer
          description: Monetary amount in major currency units
        currency:
          type: string
          description: Currency code (e.g., XAF, XOF)
        created_at:
          type: integer
          format: int64
          description: integer timestamp
        network:
          type: string
          description: Provider or network label (e.g., MTN, ORANGE, stripe)
        status:
          type: string
          description: Transaction status. Please refer to the possible values below case-sensitive.
          enum:
            - CREATED
            - INITIALISED
            - IN_PROGRESS
            - CONFIRMED
            - SUCCESS
            - PENDING
            - FAILED
            - CANCELED
            - ERRORED
            - UNDERINVESTIGATION
        fees:
          type: number
          format: float
          nullable: true
        completed_at:
          type: string
          format: date-time
          nullable: true
        notified_at:
          type: string
          format: date-time
          nullable: true
        phone_number:
          type: string
          nullable: true
        country:
          type: string
          nullable: true
        net_amount:
          type: number
          format: float
          nullable: true

    CashOutResponse:
      type: object
      properties:
        message:
          type: string
          description: Status message
        cashOut:
          $ref: '#/components/schemas/Payment'
        code:
          type: integer
          description: Numeric code representing the result
      example:
        message: "created"
        cashOut:
          id: "934ca3f6-dad6-4503-ae36-c01ca3354183"
          amount: 100
          currency: "XAF"
          created_at: 1768646496
          network: "MTN"
          status: "PENDING"
          code: 201
    VerifyResponse:
      type: object
      properties:
        code:
          type: integer
          description: Numeric code representing the result
        message:
          type: string
          description: Status message
        verify:
          $ref: '#/components/schemas/Payment'
      example:
        code: 200
        message: "success"
        verify:
          id: "934ca3f6-dad6-2005-ae36-c01ca3354183"
          external_reference: "my-site-reference"
          amount: 100
          currency: "XAF"
          fees: 3
          created_at: 1768646496
          network: "orange"
          status: "success"
          completed_at: null
          notified_at: "2026-01-02T23:14:03+01:00"
          phone_number: "+1234567890"
          net_amount: 100
          country: "CM"

    AccountResponse:
      type: object
      properties:
        code:
          type: integer
          description: Numeric code representing the result
        message:
          type: string
          description: Status message
        account:
          type: object
          properties:
            balance:
              type: integer
              description: Account balance in major currency units
            currency:
              type: string
              description: Currency code (e.g., XAF, XOF)
            date:
              type: string
              format: date-time
              description: Timestamp of when the balance was viewed
      example:
        code: 200
        message: "success"
        account:
          balance: 1000000
          currency: "XAF"
          date: "2026-01-17T10:45:57+00:00"

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: "Invalid payload"
        errors:
          type: object
          additionalProperties: true
          example:
            amount: "Amount must be numeric and greater than 0"
            phone_number: "Phone number must include country code"

  examples:
    CashOutExample:
      summary: Typical cashout request
      value:
        amount: 100
        phone_number: "+1234567890"
        notification_url: "https://myapp.com/webhook"
        currency: "XAF"
        external_reference: "my-site-reference"
        shopping_cart_details:
          order_id: "ORD-12345"
          email: "user@test.com"
          customerName: "John Doe"
          description: "Payment for order ORD-12345"
          langKey: "fr"
          items:
            - item_id: "item-001"
              name: "Product 1"
              quantity: 2
              unit_price: 25.0
            - item_id: "item-002"
              name: "Product 2"
              quantity: 1
              unit_price: 50.0
          user_browser_data:
            userAgent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
            acceptLanguage: "en-US,en;q=0.9"
            ipAddress: "1.2.3.4"

tags:
  - name: Payment
    description: Payment / cashout operations
  - name: Account
    description: Account and balance operations